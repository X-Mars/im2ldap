import{d as y,u as C,r,y as m,b as L,o as x,c as E,f as g,w as u,g as b,i as M,E as q,e as _,n as G,x as N,j as B,_ as S}from"./index-DyXSoxUy.js";const T={class:"oauth-callback"},V={class:"card-header"},A={class:"callback-content"},H=y({__name:"OAuthCallback",setup(O){const l=L(),h=M(),a=C(),c=r(!0),p=r(!1),i=r("正在处理登录请求..."),d=r("请稍候"),f=m(()=>({wecom:"企业微信",feishu:"飞书",dingtalk:"钉钉",github:"GitHub",google:"Google",gitlab:"GitLab",gitee:"Gitee"})[l.query.state]||"未知平台"),k=m(()=>`${f.value}登录`),v=async()=>{var n;try{const e=l.query.code,s=l.query.authCode,o=(n=l.query.state)==null?void 0:n.toLowerCase();if(console.log("code:",e),console.log("authCode:",s),console.log("state:",o),!e||!o||!s&&o==="dingtalk"&&o!=="github")throw new Error("缺少必要的参数");let t;switch(o){case"wecom":t=await a.wecomLogin(e);break;case"feishu":t=await a.feishuLogin(e);break;case"dingtalk":t=await a.dingtalkLogin(s);break;case"github":t=await a.githubLogin(e);break;case"google":t=await a.googleLogin(e);break;case"gitlab":t=await a.gitlabLogin(e);break;case"gitee":t=await a.giteeLogin(e);break;default:throw new Error("未知的登录类型")}c.value=!1,i.value="登录成功",d.value="正在跳转...",setTimeout(()=>{h.push("/")},1e3)}catch(e){c.value=!1,p.value=!0,i.value="登录失败",d.value=e.message||"请稍后重试",q.error(e.message||"登录失败")}},w=()=>{h.push("/")};return x(()=>{v()}),(n,e)=>{const s=b("el-button"),o=b("el-result"),t=b("el-card");return B(),E("div",T,[g(t,{class:"callback-card"},{header:u(()=>[_("div",V,[_("h2",null,N(k.value),1)])]),default:u(()=>[_("div",A,[g(o,{icon:c.value?"info":p.value?"error":"success",title:i.value,"sub-title":d.value},{extra:u(()=>[g(s,{type:"primary",onClick:w,disabled:c.value},{default:u(()=>e[0]||(e[0]=[G(" 返回首页 ")])),_:1},8,["disabled"])]),_:1},8,["icon","title","sub-title"])])]),_:1})])}}}),j=S(H,[["__scopeId","data-v-9f9d3a63"]]);export{j as default};
