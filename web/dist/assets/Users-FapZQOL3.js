import{d as ze,r as g,a as ae,y as Ge,u as Be,o as De,c as h,e as le,f as l,w as r,g as k,h as y,E as p,n as i,k as T,I as Fe,D as Se,B as I,C as Ne,t as m,x as u,J as Me,K as Re,A as L,F as je,s as Ae,L as _e,j as d,_ as He}from"./index-DyXSoxUy.js";const qe={class:"users-container"},We={class:"header"},Je={class:"left"},Ke={class:"right"},Oe={key:1},Ze={key:1},Qe={key:1},Xe={key:1},Ye={key:1},ea={key:1},aa={key:1},la={key:0,class:"select-hint"},ta=ze({__name:"Users",setup(ra){const S=g([]),A=g([]),H=g([]),q=g([]),W=g([]),J=g([]),K=g([]),O=g([]),f=ae({local:!1,wecom:!1,feishu:!1,dingtalk:!1,github:!1,google:!1,gitlab:!1,gitee:!1}),Y=g(!1),B=g(!1),v=g(null),N=g(),M=g("local"),c=ae({username:"",password:"",first_name:"",last_name:"",email:"",role:"user",is_active:!0}),be={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{validator:(t,e,o)=>{!v.value&&!e?o(new Error("请输入密码")):e&&e.length<6?o(new Error("密码长度至少为6位，并同时包含大小写字母和数字")):e&&!/[A-Z]/.test(e)?o(new Error("密码长度至少为6位，并同时包含大小写字母和数字")):e&&!/[a-z]/.test(e)?o(new Error("密码长度至少为6位，并同时包含大小写字母和数字")):e&&!/\d/.test(e)?o(new Error("密码长度至少为6位，并同时包含大小写字母和数字")):o()},trigger:"change"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},R=g(!1),j=g(!1),ge=g(),b=ae({thirdPartyUserId:"",thirdPartyUsername:"",thirdPartyType:"",localUserId:""}),Z=async()=>{f.local=!0;try{const t=await y.getUsers();S.value=t.data.map(e=>({...e,statusLoading:!1}))}catch(t){console.error(t),p.error("获取用户列表失败")}finally{f.local=!1}},te=async()=>{f.wecom=!0;try{const t=await y.getWeComUsers();A.value=t.data}catch(t){console.error(t),p.error("获取企业微信用户列表失败")}finally{f.wecom=!1}},re=async()=>{f.feishu=!0;try{const t=await y.getFeiShuUsers();H.value=t.data}catch(t){console.error(t),p.error("获取飞书用户列表失败")}finally{f.feishu=!1}},se=async()=>{f.dingtalk=!0;try{const t=await y.getDingTalkUsers();q.value=t.data}catch(t){console.error(t),p.error("获取钉钉用户列表失败")}finally{f.dingtalk=!1}},ie=async()=>{f.github=!0;try{const t=await y.getGitHubUsers();W.value=t.data}catch(t){console.error(t),p.error("获取GitHub用户列表失败")}finally{f.github=!1}},ne=async()=>{f.google=!0;try{const t=await y.getGoogleUsers();J.value=t.data}catch(t){console.error(t),p.error("获取Google用户列表失败")}finally{f.google=!1}},oe=async()=>{f.gitlab=!0;try{const t=await y.getGitLabUsers();K.value=t.data}catch(t){console.error(t),p.error("获取GitLab用户列表失败")}finally{f.gitlab=!1}},de=async()=>{f.gitee=!0;try{const t=await y.getGiteeUsers();O.value=t.data}catch(t){console.error(t),p.error("获取Gitee用户列表失败")}finally{f.gitee=!1}},ke=t=>{const e=t.props.name;M.value=e,Q(e)},ye=()=>{Q(M.value)},Q=t=>{switch(t){case"local":Z();break;case"wecom":te();break;case"feishu":re();break;case"dingtalk":se();break;case"github":ie();break;case"google":ne();break;case"gitlab":oe();break;case"gitee":de();break}},ee=Ge(()=>{const t=new Set;if(A.value.forEach(e=>{e.linked&&e.user_id&&t.add(e.user_id)}),H.value.forEach(e=>{e.linked&&e.user_id&&t.add(e.user_id)}),q.value.forEach(e=>{e.linked&&e.user_id&&t.add(e.user_id)}),W.value.forEach(e=>{e.linked&&e.user_id&&t.add(e.user_id)}),J.value.forEach(e=>{e.linked&&e.user_id&&t.add(e.user_id)}),K.value.forEach(e=>{e.linked&&e.user_id&&t.add(e.user_id)}),O.value.forEach(e=>{e.linked&&e.user_id&&t.add(e.user_id)}),b.thirdPartyType&&b.thirdPartyUserId){const e=ve(b.thirdPartyType,b.thirdPartyUserId);e&&t.delete(e)}return S.value.filter(e=>!t.has(e.id))}),ve=(t,e)=>{let o;switch(t){case"wecom":o=A.value.find(n=>n.id===e);break;case"feishu":o=H.value.find(n=>n.id===e);break;case"dingtalk":o=q.value.find(n=>n.id===e);break;case"github":o=W.value.find(n=>n.id===e);break;case"google":o=J.value.find(n=>n.id===e);break;case"gitlab":o=K.value.find(n=>n.id===e);break;case"gitee":o=O.value.find(n=>n.id===e);break}return o&&o.linked&&o.user_id?o.user_id:null},P=(t,e)=>{R.value=!0,b.thirdPartyUserId=t.id,b.thirdPartyUsername=`${t.name} (${t.username||t.email})`,b.thirdPartyType=e,t.linked&&t.user_id?b.localUserId=t.user_id:b.localUserId="",S.value.length===0&&Z()},he=async()=>{if(!b.localUserId||!b.thirdPartyUserId||!b.thirdPartyType){p.warning("请选择本地用户");return}j.value=!0;try{await y.linkUser(b.localUserId,b.thirdPartyUserId,b.thirdPartyType),p.success("关联成功"),R.value=!1,Q(b.thirdPartyType)}catch(t){console.error(t),t.response&&t.response.data&&t.response.data.error?p.error(t.response.data.error):p.error("关联用户失败")}finally{j.value=!1}},Ue=()=>{N.value&&N.value.resetFields(),c.username="",c.password="",c.first_name="",c.last_name="",c.email="",c.role="user",c.is_active=!0,v.value=null},Ce=()=>{Ue(),B.value=!0},Ve=t=>{v.value=t,Object.assign(c,{username:t.username,password:"",first_name:t.first_name,last_name:t.last_name,email:t.email,role:t.role,is_active:t.is_active}),B.value=!0},we=()=>{N.value&&N.value.validate(async t=>{if(t){Y.value=!0;try{v.value?(await y.updateUser(v.value.id,c),p.success("保存成功")):(await y.createUser(c),p.success("创建成功")),B.value=!1,Z()}catch(e){console.error(e),p.error("保存失败")}finally{Y.value=!1}}})},$e=async t=>{var e;if(t.username===((e=D.user)==null?void 0:e.username)){p.warning("不能删除自己的账号");return}try{await _e.confirm("确定要删除该用户吗？此操作不可恢复","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await y.deleteUser(t.id),p.success("删除成功"),await Z()}catch(o){o!=="cancel"&&(console.error(o),p.error("删除失败"))}},U=t=>t?new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-"):"",xe=async t=>{var e;if(t.username===((e=D.user)==null?void 0:e.username)&&!t.is_active){p.warning("不能禁用自己的账号"),t.is_active=!0;return}t.statusLoading=!0;try{await y.updateUser(t.id,{is_active:t.is_active}),p.success(`已${t.is_active?"启用":"禁用"}用户`)}catch(o){console.error(o),p.error("更新状态失败"),t.is_active=!t.is_active}finally{t.statusLoading=!1}},D=Be(),Te=t=>({superuser:"超级管理员",admin:"管理员",user:"普通用户"})[t]||t,Ie=t=>({superuser:"danger",admin:"warning",user:"success"})[t]||"info",E=t=>{if(!t)return"未知用户";const e=S.value.find(o=>o.id===t);return e?`${e.first_name} ${e.last_name} (${e.username})`:"未知用户"},z=async(t,e)=>{if(!t.user_id){p.warning("未找到已关联的本地用户");return}try{switch(await _e.confirm("确定要解除关联吗？解除关联后，该第三方用户将无法使用关联的本地账号登录。","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),j.value=!0,await y.unlinkUser(t.user_id,e),p.success("已解除关联"),e){case"wecom":te();break;case"feishu":re();break;case"dingtalk":se();break;case"github":ie();break;case"google":ne();break;case"gitlab":oe();break;case"gitee":de();break}}catch(o){o!=="cancel"&&(console.error(o),o.response&&o.response.data&&o.response.data.message?p.error(o.response.data.message):p.error("解除关联失败"))}finally{j.value=!1}};return De(()=>{Q(M.value)}),(t,e)=>{const o=k("el-icon"),n=k("el-button"),s=k("el-table-column"),V=k("el-tag"),ue=k("el-switch"),Le=k("el-button-group"),w=k("el-table"),$=k("el-tab-pane"),Pe=k("el-tabs"),F=k("el-input"),C=k("el-form-item"),X=k("el-option"),ce=k("el-select"),pe=k("el-form"),fe=k("el-dialog"),x=Ne("loading");return d(),h("div",qe,[le("div",We,[le("div",Je,[l(n,{type:"primary",onClick:Ce},{default:r(()=>[l(o,null,{default:r(()=>[l(T(Fe))]),_:1}),e[14]||(e[14]=i("新建用户 "))]),_:1})]),le("div",Ke,[l(n,{type:"info",onClick:ye},{default:r(()=>[l(o,null,{default:r(()=>[l(T(Se))]),_:1}),e[15]||(e[15]=i("刷新 "))]),_:1})])]),l(Pe,{modelValue:M.value,"onUpdate:modelValue":e[0]||(e[0]=a=>M.value=a),onTabClick:ke},{default:r(()=>[l($,{label:"本地用户",name:"local"},{default:r(()=>[I((d(),m(w,{data:S.value,stripe:""},{default:r(()=>[l(s,{prop:"username",label:"用户名"}),l(s,{prop:"first_name",label:"姓名"},{default:r(({row:a})=>[i(u(a.first_name)+" "+u(a.last_name),1)]),_:1}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"role",label:"角色"},{default:r(({row:a})=>[l(V,{type:Ie(a.role)},{default:r(()=>[i(u(Te(a.role)),1)]),_:2},1032,["type"])]),_:1}),l(s,{prop:"is_active",label:"状态",width:"100"},{default:r(({row:a})=>{var _;return[l(ue,{modelValue:a.is_active,"onUpdate:modelValue":G=>a.is_active=G,loading:a.statusLoading,onChange:G=>xe(a),"active-text":a.is_active?"启用":"禁用",disabled:a.username===((_=T(D).user)==null?void 0:_.username),"inline-prompt":""},null,8,["modelValue","onUpdate:modelValue","loading","onChange","active-text","disabled"])]}),_:1}),l(s,{prop:"last_active_at",label:"最后活跃时间"},{default:r(({row:a})=>[i(u(U(a.last_active_at)),1)]),_:1}),l(s,{prop:"date_joined",label:"加入时间"},{default:r(({row:a})=>[i(u(U(a.date_joined)),1)]),_:1}),l(s,{label:"操作",width:200,fixed:"right"},{default:r(({row:a})=>[l(Le,null,{default:r(()=>{var _;return[l(n,{type:"primary",icon:T(Me),onClick:G=>Ve(a)},{default:r(()=>e[16]||(e[16]=[i(" 编辑 ")])),_:2},1032,["icon","onClick"]),l(n,{type:"danger",icon:T(Re),disabled:a.username===((_=T(D).user)==null?void 0:_.username),onClick:G=>$e(a)},{default:r(()=>e[17]||(e[17]=[i(" 删除 ")])),_:2},1032,["icon","disabled","onClick"])]}),_:2},1024)]),_:1})]),_:1},8,["data"])),[[x,f.local]])]),_:1}),l($,{label:"企业微信用户",name:"wecom"},{default:r(()=>[I((d(),m(w,{data:A.value,stripe:""},{default:r(()=>[l(s,{prop:"name",label:"姓名"}),l(s,{prop:"username",label:"用户名"}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"mobile",label:"手机号"}),l(s,{prop:"department",label:"部门"}),l(s,{prop:"position",label:"职位"}),l(s,{prop:"created_at",label:"创建时间"},{default:r(({row:a})=>[i(u(U(a.created_at)),1)]),_:1}),l(s,{label:"已关联本地用户",width:"180"},{default:r(({row:a})=>[a.linked?(d(),m(V,{key:0,type:"success"},{default:r(()=>[i(u(E(a.user_id)),1)]),_:2},1024)):(d(),h("span",Oe,"未关联"))]),_:1}),l(s,{label:"操作",width:"200",fixed:"right"},{default:r(({row:a})=>[l(n,{type:"primary",size:"small",onClick:_=>P(a,"wecom")},{default:r(()=>[i(u(a.linked?"修改关联":"关联本地用户"),1)]),_:2},1032,["onClick"]),a.linked?(d(),m(n,{key:0,type:"danger",size:"small",onClick:_=>z(a,"wecom")},{default:r(()=>e[18]||(e[18]=[i(" 解除关联 ")])),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])),[[x,f.wecom]])]),_:1}),l($,{label:"飞书用户",name:"feishu"},{default:r(()=>[I((d(),m(w,{data:H.value,stripe:""},{default:r(()=>[l(s,{prop:"name",label:"姓名"}),l(s,{prop:"username",label:"用户名"}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"mobile",label:"手机号"}),l(s,{prop:"department",label:"部门"}),l(s,{prop:"position",label:"职位"}),l(s,{prop:"created_at",label:"创建时间"},{default:r(({row:a})=>[i(u(U(a.created_at)),1)]),_:1}),l(s,{label:"已关联本地用户",width:"180"},{default:r(({row:a})=>[a.linked?(d(),m(V,{key:0,type:"success"},{default:r(()=>[i(u(E(a.user_id)),1)]),_:2},1024)):(d(),h("span",Ze,"未关联"))]),_:1}),l(s,{label:"操作",width:"200",fixed:"right"},{default:r(({row:a})=>[l(n,{type:"primary",size:"small",onClick:_=>P(a,"feishu")},{default:r(()=>[i(u(a.linked?"修改关联":"关联本地用户"),1)]),_:2},1032,["onClick"]),a.linked?(d(),m(n,{key:0,type:"danger",size:"small",onClick:_=>z(a,"feishu")},{default:r(()=>e[19]||(e[19]=[i(" 解除关联 ")])),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])),[[x,f.feishu]])]),_:1}),l($,{label:"钉钉用户",name:"dingtalk"},{default:r(()=>[I((d(),m(w,{data:q.value,stripe:""},{default:r(()=>[l(s,{prop:"name",label:"姓名"}),l(s,{prop:"username",label:"用户名"}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"mobile",label:"手机号"}),l(s,{prop:"department",label:"部门"}),l(s,{prop:"position",label:"职位"}),l(s,{prop:"created_at",label:"创建时间"},{default:r(({row:a})=>[i(u(U(a.created_at)),1)]),_:1}),l(s,{label:"已关联本地用户",width:"180"},{default:r(({row:a})=>[a.linked?(d(),m(V,{key:0,type:"success"},{default:r(()=>[i(u(E(a.user_id)),1)]),_:2},1024)):(d(),h("span",Qe,"未关联"))]),_:1}),l(s,{label:"操作",width:"200",fixed:"right"},{default:r(({row:a})=>[l(n,{type:"primary",size:"small",onClick:_=>P(a,"dingtalk")},{default:r(()=>[i(u(a.linked?"修改关联":"关联本地用户"),1)]),_:2},1032,["onClick"]),a.linked?(d(),m(n,{key:0,type:"danger",size:"small",onClick:_=>z(a,"dingtalk")},{default:r(()=>e[20]||(e[20]=[i(" 解除关联 ")])),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])),[[x,f.dingtalk]])]),_:1}),l($,{label:"GitHub用户",name:"github"},{default:r(()=>[I((d(),m(w,{data:W.value,stripe:""},{default:r(()=>[l(s,{prop:"name",label:"姓名"}),l(s,{prop:"username",label:"用户名"}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"created_at",label:"创建时间"},{default:r(({row:a})=>[i(u(U(a.created_at)),1)]),_:1}),l(s,{label:"已关联本地用户",width:"180"},{default:r(({row:a})=>[a.linked?(d(),m(V,{key:0,type:"success"},{default:r(()=>[i(u(E(a.user_id)),1)]),_:2},1024)):(d(),h("span",Xe,"未关联"))]),_:1}),l(s,{label:"操作",width:"200",fixed:"right"},{default:r(({row:a})=>[l(n,{type:"primary",size:"small",onClick:_=>P(a,"github")},{default:r(()=>[i(u(a.linked?"修改关联":"关联本地用户"),1)]),_:2},1032,["onClick"]),a.linked?(d(),m(n,{key:0,type:"danger",size:"small",onClick:_=>z(a,"github")},{default:r(()=>e[21]||(e[21]=[i(" 解除关联 ")])),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])),[[x,f.github]])]),_:1}),l($,{label:"Google用户",name:"google"},{default:r(()=>[I((d(),m(w,{data:J.value,stripe:""},{default:r(()=>[l(s,{prop:"name",label:"姓名"}),l(s,{prop:"username",label:"用户名"}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"created_at",label:"创建时间"},{default:r(({row:a})=>[i(u(U(a.created_at)),1)]),_:1}),l(s,{label:"已关联本地用户",width:"180"},{default:r(({row:a})=>[a.linked?(d(),m(V,{key:0,type:"success"},{default:r(()=>[i(u(E(a.user_id)),1)]),_:2},1024)):(d(),h("span",Ye,"未关联"))]),_:1}),l(s,{label:"操作",width:"200",fixed:"right"},{default:r(({row:a})=>[l(n,{type:"primary",size:"small",onClick:_=>P(a,"google")},{default:r(()=>[i(u(a.linked?"修改关联":"关联本地用户"),1)]),_:2},1032,["onClick"]),a.linked?(d(),m(n,{key:0,type:"danger",size:"small",onClick:_=>z(a,"google")},{default:r(()=>e[22]||(e[22]=[i(" 解除关联 ")])),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])),[[x,f.google]])]),_:1}),l($,{label:"GitLab用户",name:"gitlab"},{default:r(()=>[I((d(),m(w,{data:K.value,stripe:""},{default:r(()=>[l(s,{prop:"name",label:"姓名"}),l(s,{prop:"username",label:"用户名"}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"created_at",label:"创建时间"},{default:r(({row:a})=>[i(u(U(a.created_at)),1)]),_:1}),l(s,{label:"已关联本地用户",width:"180"},{default:r(({row:a})=>[a.linked?(d(),m(V,{key:0,type:"success"},{default:r(()=>[i(u(E(a.user_id)),1)]),_:2},1024)):(d(),h("span",ea,"未关联"))]),_:1}),l(s,{label:"操作",width:"200",fixed:"right"},{default:r(({row:a})=>[l(n,{type:"primary",size:"small",onClick:_=>P(a,"gitlab")},{default:r(()=>[i(u(a.linked?"修改关联":"关联本地用户"),1)]),_:2},1032,["onClick"]),a.linked?(d(),m(n,{key:0,type:"danger",size:"small",onClick:_=>z(a,"gitlab")},{default:r(()=>e[23]||(e[23]=[i(" 解除关联 ")])),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])),[[x,f.gitlab]])]),_:1}),l($,{label:"Gitee用户",name:"gitee"},{default:r(()=>[I((d(),m(w,{data:O.value,stripe:""},{default:r(()=>[l(s,{prop:"name",label:"姓名"}),l(s,{prop:"username",label:"用户名"}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"created_at",label:"创建时间"},{default:r(({row:a})=>[i(u(U(a.created_at)),1)]),_:1}),l(s,{label:"已关联本地用户",width:"180"},{default:r(({row:a})=>[a.linked?(d(),m(V,{key:0,type:"success"},{default:r(()=>[i(u(E(a.user_id)),1)]),_:2},1024)):(d(),h("span",aa,"未关联"))]),_:1}),l(s,{label:"操作",width:"200",fixed:"right"},{default:r(({row:a})=>[l(n,{type:"primary",size:"small",onClick:_=>P(a,"gitee")},{default:r(()=>[i(u(a.linked?"修改关联":"关联本地用户"),1)]),_:2},1032,["onClick"]),a.linked?(d(),m(n,{key:0,type:"danger",size:"small",onClick:_=>z(a,"gitee")},{default:r(()=>e[24]||(e[24]=[i(" 解除关联 ")])),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])),[[x,f.gitee]])]),_:1})]),_:1},8,["modelValue"]),l(fe,{modelValue:B.value,"onUpdate:modelValue":e[9]||(e[9]=a=>B.value=a),title:v.value?"编辑用户":"新建用户",width:"500px"},{footer:r(()=>[l(n,{onClick:e[8]||(e[8]=a=>B.value=!1)},{default:r(()=>e[25]||(e[25]=[i("取消")])),_:1}),l(n,{type:"primary",onClick:we,loading:Y.value},{default:r(()=>e[26]||(e[26]=[i(" 确定 ")])),_:1},8,["loading"])]),default:r(()=>[l(pe,{ref_key:"formRef",ref:N,model:c,rules:be,"label-width":"100px"},{default:r(()=>[l(C,{label:"用户名",prop:"username"},{default:r(()=>[l(F,{modelValue:c.username,"onUpdate:modelValue":e[1]||(e[1]=a=>c.username=a)},null,8,["modelValue"])]),_:1}),l(C,{label:"密码",prop:"password",rules:[{required:!v.value,message:"请输入密码"}]},{default:r(()=>{var a,_,G,me;return[l(F,{modelValue:c.password,"onUpdate:modelValue":e[2]||(e[2]=Ee=>c.password=Ee),type:"password",disabled:((a=v.value)==null?void 0:a.username)===((_=T(D).user)==null?void 0:_.username),placeholder:((G=v.value)==null?void 0:G.username)===((me=T(D).user)==null?void 0:me.username)?"不能修改自己的密码":v.value?"不修改请留空":"请输入密码"},null,8,["modelValue","disabled","placeholder"])]}),_:1},8,["rules"]),l(C,{label:"姓",prop:"first_name"},{default:r(()=>[l(F,{modelValue:c.first_name,"onUpdate:modelValue":e[3]||(e[3]=a=>c.first_name=a)},null,8,["modelValue"])]),_:1}),l(C,{label:"名",prop:"last_name"},{default:r(()=>[l(F,{modelValue:c.last_name,"onUpdate:modelValue":e[4]||(e[4]=a=>c.last_name=a)},null,8,["modelValue"])]),_:1}),l(C,{label:"邮箱",prop:"email"},{default:r(()=>[l(F,{modelValue:c.email,"onUpdate:modelValue":e[5]||(e[5]=a=>c.email=a)},null,8,["modelValue"])]),_:1}),l(C,{label:"角色",prop:"role"},{default:r(()=>[l(ce,{modelValue:c.role,"onUpdate:modelValue":e[6]||(e[6]=a=>c.role=a)},{default:r(()=>[l(X,{label:"超级管理员",value:"superuser"}),l(X,{label:"管理员",value:"admin"}),l(X,{label:"普通用户",value:"user"})]),_:1},8,["modelValue"])]),_:1}),l(C,{label:"状态",prop:"is_active"},{default:r(()=>[l(ue,{modelValue:c.is_active,"onUpdate:modelValue":e[7]||(e[7]=a=>c.is_active=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(fe,{modelValue:R.value,"onUpdate:modelValue":e[13]||(e[13]=a=>R.value=a),title:"关联本地用户",width:"500px"},{footer:r(()=>[l(n,{onClick:e[12]||(e[12]=a=>R.value=!1)},{default:r(()=>e[27]||(e[27]=[i("取消")])),_:1}),l(n,{type:"primary",onClick:he,loading:j.value,disabled:ee.value.length===0},{default:r(()=>e[28]||(e[28]=[i("确定")])),_:1},8,["loading","disabled"])]),default:r(()=>[l(pe,{ref_key:"linkFormRef",ref:ge,model:b,"label-width":"100px"},{default:r(()=>[l(C,{label:"第三方用户",prop:"thirdPartyUser"},{default:r(()=>[l(F,{modelValue:b.thirdPartyUsername,"onUpdate:modelValue":e[10]||(e[10]=a=>b.thirdPartyUsername=a),disabled:""},null,8,["modelValue"])]),_:1}),l(C,{label:"本地用户",prop:"localUserId"},{default:r(()=>[l(ce,{modelValue:b.localUserId,"onUpdate:modelValue":e[11]||(e[11]=a=>b.localUserId=a),filterable:"",placeholder:"请选择本地用户"},{default:r(()=>[(d(!0),h(je,null,Ae(ee.value,a=>(d(),m(X,{key:a.id,label:`${a.first_name} ${a.last_name} (${a.username})`,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),ee.value.length===0?(d(),h("div",la," 没有可用的空闲本地用户，所有用户都已被关联 ")):L("",!0)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),ia=He(ta,[["__scopeId","data-v-be461bee"]]);export{ia as default};
